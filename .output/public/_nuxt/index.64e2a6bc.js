import{d as m,r as b,o as y,l as i,z as D,_ as k,A as v,B as w,f as C,q as u,s as S,m as h,t as g,F as $,C as M,k as r,v as T,x as A,y as F}from"./entry.c61ee406.js";import{u as p}from"./diary.db5a6022.js";const N=m({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(t,{slots:e,attrs:s}){const o=b(!1);return y(()=>{o.value=!0}),n=>{var a;if(o.value)return(a=e.default)==null?void 0:a.call(e);const l=e.fallback||e.placeholder;if(l)return l();const d=n.fallback||n.placeholder||"",c=n.fallbackTag||n.placeholderTag||"span";return i(c,s,d)}}}),_=()=>({page:{year:new Date().getFullYear(),month:new Date().getMonth()+1},date:{date:new Date,todos:null},attributes:[],list:[],todos:[]}),f=D("calendar",{state:_,actions:{setPage(t){this.page.year=t.getFullYear(),this.page.month=t.getMonth()+1,this.getCalendarList()},setDate(t){this.date.date=t,this.setPage(t),this.attributes=this.attributes.filter(e=>!e.highlight),this.attributes.push({key:t.getDate(),highlight:{color:"black",fillMode:"outline"},dates:t}),this.getCalendar()},setAttributes(){this.attributes=this.attributes.filter(t=>t.highlight),this.list.forEach(t=>{const e=[],s=new Date(t.start_time),o=new Date(t.end_time);for(;s<=o;)e.push(new Date(s)),s.setDate(s.getDate()+1);const n={key:t.id,dot:"light-gray",dates:e};this.attributes.push(n)})},async getCalendarList(){const{getCalendarList:t}=p(),e=await t(this.page.year,this.page.month);this.list=e.data,this.setAttributes()},async getCalendar(){const{getCalendar:t}=p(),e=await t(this.date.date.getFullYear(),this.date.date.getMonth()+1,this.date.date.getDate());this.todos=e.data},reset(){Object.assign(this.$state,_())}}});const V={name:"Calendar",setup(){},computed:{...v(f,["page","date","attributes","todos"])},async mounted(){this.reset();let t=new Date(this.$route.query.date);(!t||isNaN(t))&&(t=new Date),this.setDate(t)},methods:{...w(f,["setDate","setPage","reset"])}},B=t=>(A("data-v-49c8bafb"),t=t(),F(),t),I={class:"contents"},L={class:"bottom-sheet"},P={class:"calendar-title"},Y={key:0,class:"calendar-contents"},j=B(()=>h("div",{class:"circle"},null,-1)),q={key:1,class:"calendar-none"};function E(t,e,s,o,n,l){const d=C("VCalendar"),c=N;return r(),i("div",I,[u(c,null,{default:S(()=>[u(d,{ref:"vcalendar",style:{width:"90%"},"trim-weeks":"","initial-page":t.page,attributes:t.attributes,onDayclick:e[0]||(e[0]=a=>t.setDate(a.date)),onDidMove:e[1]||(e[1]=a=>t.setPage(new Date(a[0].id)))},null,8,["initial-page","attributes"])]),_:1}),h("div",L,[h("div",P,g(t.$dayjs(t.date.date).format("D. dd")),1),t.todos&&t.todos.length>0?(r(),i("div",Y,[(r(!0),i($,null,M(t.todos,a=>(r(),i("div",{class:"calendar-content",key:a},[j,T(" "+g(a.diary_name),1)]))),128))])):(r(),i("div",q,"일정이 없습니다"))])])}const z=k(V,[["render",E],["__scopeId","data-v-49c8bafb"]]);export{z as default};
